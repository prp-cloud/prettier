(function(n){function e(){var i=n();return i.default||i}if(typeof exports=="object"&&typeof module=="object")module.exports=e();else if(typeof define=="function"&&define.amd)define(e);else{var t=typeof globalThis<"u"?globalThis:typeof global<"u"?global:typeof self<"u"?self:this||{};t.prettierPlugins=t.prettierPlugins||{},t.prettierPlugins.angular=e()}})(function(){"use strict";var Ct=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var ke=Object.getOwnPropertyNames;var Ne=Object.prototype.hasOwnProperty;var Dt=(r,t)=>{for(var e in t)Ct(r,e,{get:t[e],enumerable:!0})},Le=(r,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ke(t))!Ne.call(r,i)&&i!==e&&Ct(r,i,{get:()=>t[i],enumerable:!(s=Ie(t,i))||s.enumerable});return r};var Re=r=>Le(Ct({},"__esModule",{value:!0}),r);var Ps={};Dt(Ps,{parsers:()=>Ut});var Ut={};Dt(Ut,{__ng_action:()=>ks,__ng_binding:()=>Ns,__ng_directive:()=>Rs,__ng_interpolation:()=>Ls});var F=class{constructor(t,e,s,i){this.input=e,this.errLocation=s,this.ctxLocation=i,this.message=`Parser Error: ${t} ${s} [${e}] in ${i}`}},O=class{constructor(t,e){this.start=t,this.end=e}toAbsolute(t){return new E(t+this.start,t+this.end)}},l=class{constructor(t,e){this.span=t,this.sourceSpan=e}toString(){return"AST"}},D=class extends l{constructor(t,e,s){super(t,e),this.nameSpan=s}},v=class extends l{visit(t,e=null){}},I=class extends l{visit(t,e=null){return t.visitImplicitReceiver(this,e)}},dt=class extends I{visit(t,e=null){return t.visitThisReceiver?.(this,e)}},W=class extends l{constructor(t,e,s){super(t,e),this.expressions=s}visit(t,e=null){return t.visitChain(this,e)}},G=class extends l{constructor(t,e,s,i,n){super(t,e),this.condition=s,this.trueExp=i,this.falseExp=n}visit(t,e=null){return t.visitConditional(this,e)}},L=class extends D{constructor(t,e,s,i,n){super(t,e,s),this.receiver=i,this.name=n}visit(t,e=null){return t.visitPropertyRead(this,e)}},V=class extends D{constructor(t,e,s,i,n,a){super(t,e,s),this.receiver=i,this.name=n,this.value=a}visit(t,e=null){return t.visitPropertyWrite(this,e)}},R=class extends D{constructor(t,e,s,i,n){super(t,e,s),this.receiver=i,this.name=n}visit(t,e=null){return t.visitSafePropertyRead(this,e)}},Q=class extends l{constructor(t,e,s,i){super(t,e),this.receiver=s,this.key=i}visit(t,e=null){return t.visitKeyedRead(this,e)}},P=class extends l{constructor(t,e,s,i){super(t,e),this.receiver=s,this.key=i}visit(t,e=null){return t.visitSafeKeyedRead(this,e)}},z=class extends l{constructor(t,e,s,i,n){super(t,e),this.receiver=s,this.key=i,this.value=n}visit(t,e=null){return t.visitKeyedWrite(this,e)}},q=class extends D{constructor(t,e,s,i,n,a){super(t,e,a),this.exp=s,this.name=i,this.args=n}visit(t,e=null){return t.visitPipe(this,e)}},g=class extends l{constructor(t,e,s){super(t,e),this.value=s}visit(t,e=null){return t.visitLiteralPrimitive(this,e)}},H=class extends l{constructor(t,e,s){super(t,e),this.expressions=s}visit(t,e=null){return t.visitLiteralArray(this,e)}},j=class extends l{constructor(t,e,s,i){super(t,e),this.keys=s,this.values=i}visit(t,e=null){return t.visitLiteralMap(this,e)}},Y=class extends l{constructor(t,e,s,i){super(t,e),this.strings=s,this.expressions=i}visit(t,e=null){return t.visitInterpolation(this,e)}},m=class extends l{constructor(t,e,s,i,n){super(t,e),this.operation=s,this.left=i,this.right=n}visit(t,e=null){return t.visitBinary(this,e)}},b=class r extends m{static createMinus(t,e,s){return new r(t,e,"-",s,"-",new g(t,e,0),s)}static createPlus(t,e,s){return new r(t,e,"+",s,"-",s,new g(t,e,0))}constructor(t,e,s,i,n,a,o){super(t,e,n,a,o),this.operator=s,this.expr=i,this.left=null,this.right=null,this.operation=null}visit(t,e=null){return t.visitUnary!==void 0?t.visitUnary(this,e):t.visitBinary(this,e)}},Z=class extends l{constructor(t,e,s){super(t,e),this.expression=s}visit(t,e=null){return t.visitPrefixNot(this,e)}},J=class extends l{constructor(t,e,s){super(t,e),this.expression=s}visit(t,e=null){return t.visitNonNullAssert(this,e)}},X=class extends l{constructor(t,e,s,i,n){super(t,e),this.receiver=s,this.args=i,this.argumentSpan=n}visit(t,e=null){return t.visitCall(this,e)}},K=class extends l{constructor(t,e,s,i,n){super(t,e),this.receiver=s,this.args=i,this.argumentSpan=n}visit(t,e=null){return t.visitSafeCall(this,e)}},E=class{constructor(t,e){this.start=t,this.end=e}},C=class extends l{constructor(t,e,s,i,n){super(new O(0,e===null?0:e.length),new E(i,e===null?i:i+e.length)),this.ast=t,this.source=e,this.location=s,this.errors=n}visit(t,e=null){return t.visitASTWithSource?t.visitASTWithSource(this,e):this.ast.visit(t,e)}toString(){return`${this.source} in ${this.location}`}},T=class{constructor(t,e,s){this.sourceSpan=t,this.key=e,this.value=s}},tt=class{constructor(t,e,s){this.sourceSpan=t,this.key=e,this.value=s}},vt=class{visit(t,e){t.visit(this,e)}visitUnary(t,e){this.visit(t.expr,e)}visitBinary(t,e){this.visit(t.left,e),this.visit(t.right,e)}visitChain(t,e){this.visitAll(t.expressions,e)}visitConditional(t,e){this.visit(t.condition,e),this.visit(t.trueExp,e),this.visit(t.falseExp,e)}visitPipe(t,e){this.visit(t.exp,e),this.visitAll(t.args,e)}visitImplicitReceiver(t,e){}visitThisReceiver(t,e){}visitInterpolation(t,e){this.visitAll(t.expressions,e)}visitKeyedRead(t,e){this.visit(t.receiver,e),this.visit(t.key,e)}visitKeyedWrite(t,e){this.visit(t.receiver,e),this.visit(t.key,e),this.visit(t.value,e)}visitLiteralArray(t,e){this.visitAll(t.expressions,e)}visitLiteralMap(t,e){this.visitAll(t.values,e)}visitLiteralPrimitive(t,e){}visitPrefixNot(t,e){this.visit(t.expression,e)}visitNonNullAssert(t,e){this.visit(t.expression,e)}visitPropertyRead(t,e){this.visit(t.receiver,e)}visitPropertyWrite(t,e){this.visit(t.receiver,e),this.visit(t.value,e)}visitSafePropertyRead(t,e){this.visit(t.receiver,e)}visitSafeKeyedRead(t,e){this.visit(t.receiver,e),this.visit(t.key,e)}visitCall(t,e){this.visit(t.receiver,e),this.visitAll(t.args,e)}visitSafeCall(t,e){this.visit(t.receiver,e),this.visitAll(t.args,e)}visitAll(t,e){for(let s of t)this.visit(s,e)}};var Wt;(function(r){r[r.DEFAULT=0]="DEFAULT",r[r.LITERAL_ATTR=1]="LITERAL_ATTR",r[r.ANIMATION=2]="ANIMATION",r[r.TWO_WAY=3]="TWO_WAY"})(Wt||(Wt={}));var Gt;(function(r){r[r.Regular=0]="Regular",r[r.Animation=1]="Animation",r[r.TwoWay=2]="TwoWay"})(Gt||(Gt={}));var Vt;(function(r){r[r.Property=0]="Property",r[r.Attribute=1]="Attribute",r[r.Class=2]="Class",r[r.Style=3]="Style",r[r.Animation=4]="Animation",r[r.TwoWay=5]="TwoWay"})(Vt||(Vt={}));function Qt(r){return r>=9&&r<=32||r==160}function k(r){return 48<=r&&r<=57}function zt(r){return r>=97&&r<=122||r>=65&&r<=90}function At(r){return r===39||r===34||r===96}var p;(function(r){r[r.Character=0]="Character",r[r.Identifier=1]="Identifier",r[r.PrivateIdentifier=2]="PrivateIdentifier",r[r.Keyword=3]="Keyword",r[r.String=4]="String",r[r.Operator=5]="Operator",r[r.Number=6]="Number",r[r.Error=7]="Error"})(p||(p={}));var os=["var","let","as","null","undefined","true","false","if","else","this"],ct=class{tokenize(t){let e=new kt(t),s=[],i=e.scanToken();for(;i!=null;)s.push(i),i=e.scanToken();return s}},S=class{constructor(t,e,s,i,n){this.index=t,this.end=e,this.type=s,this.numValue=i,this.strValue=n}isCharacter(t){return this.type==p.Character&&this.numValue==t}isNumber(){return this.type==p.Number}isString(){return this.type==p.String}isOperator(t){return this.type==p.Operator&&this.strValue==t}isIdentifier(){return this.type==p.Identifier}isPrivateIdentifier(){return this.type==p.PrivateIdentifier}isKeyword(){return this.type==p.Keyword}isKeywordLet(){return this.type==p.Keyword&&this.strValue=="let"}isKeywordAs(){return this.type==p.Keyword&&this.strValue=="as"}isKeywordNull(){return this.type==p.Keyword&&this.strValue=="null"}isKeywordUndefined(){return this.type==p.Keyword&&this.strValue=="undefined"}isKeywordTrue(){return this.type==p.Keyword&&this.strValue=="true"}isKeywordFalse(){return this.type==p.Keyword&&this.strValue=="false"}isKeywordThis(){return this.type==p.Keyword&&this.strValue=="this"}isError(){return this.type==p.Error}toNumber(){return this.type==p.Number?this.numValue:-1}toString(){switch(this.type){case p.Character:case p.Identifier:case p.Keyword:case p.Operator:case p.PrivateIdentifier:case p.String:case p.Error:return this.strValue;case p.Number:return this.numValue.toString();default:return null}}};function Zt(r,t,e){return new S(r,t,p.Character,e,String.fromCharCode(e))}function cs(r,t,e){return new S(r,t,p.Identifier,0,e)}function hs(r,t,e){return new S(r,t,p.PrivateIdentifier,0,e)}function ps(r,t,e){return new S(r,t,p.Keyword,0,e)}function It(r,t,e){return new S(r,t,p.Operator,0,e)}function us(r,t,e){return new S(r,t,p.String,0,e)}function ls(r,t,e){return new S(r,t,p.Number,e,"")}function xs(r,t,e){return new S(r,t,p.Error,0,e)}var wt=new S(-1,-1,p.Character,0,""),kt=class{constructor(t){this.input=t,this.peek=0,this.index=-1,this.length=t.length,this.advance()}advance(){this.peek=++this.index>=this.length?0:this.input.charCodeAt(this.index)}scanToken(){let t=this.input,e=this.length,s=this.peek,i=this.index;for(;s<=32;)if(++i>=e){s=0;break}else s=t.charCodeAt(i);if(this.peek=s,this.index=i,i>=e)return null;if(Jt(s))return this.scanIdentifier();if(k(s))return this.scanNumber(i);let n=i;switch(s){case 46:return this.advance(),k(this.peek)?this.scanNumber(n):Zt(n,this.index,46);case 40:case 41:case 123:case 125:case 91:case 93:case 44:case 58:case 59:return this.scanCharacter(n,s);case 39:case 34:return this.scanString();case 35:return this.scanPrivateIdentifier();case 43:case 45:case 42:case 47:case 37:case 94:return this.scanOperator(n,String.fromCharCode(s));case 63:return this.scanQuestion(n);case 60:case 62:return this.scanComplexOperator(n,String.fromCharCode(s),61,"=");case 33:case 61:return this.scanComplexOperator(n,String.fromCharCode(s),61,"=",61,"=");case 38:return this.scanComplexOperator(n,"&",38,"&");case 124:return this.scanComplexOperator(n,"|",124,"|");case 160:for(;Qt(this.peek);)this.advance();return this.scanToken()}return this.advance(),this.error(`Unexpected character [${String.fromCharCode(s)}]`,0)}scanCharacter(t,e){return this.advance(),Zt(t,this.index,e)}scanOperator(t,e){return this.advance(),It(t,this.index,e)}scanComplexOperator(t,e,s,i,n,a){this.advance();let o=e;return this.peek==s&&(this.advance(),o+=i),n!=null&&this.peek==n&&(this.advance(),o+=a),It(t,this.index,o)}scanIdentifier(){let t=this.index;for(this.advance();Xt(this.peek);)this.advance();let e=this.input.substring(t,this.index);return os.indexOf(e)>-1?ps(t,this.index,e):cs(t,this.index,e)}scanPrivateIdentifier(){let t=this.index;if(this.advance(),!Jt(this.peek))return this.error("Invalid character [#]",-1);for(;Xt(this.peek);)this.advance();let e=this.input.substring(t,this.index);return hs(t,this.index,e)}scanNumber(t){let e=this.index===t,s=!1;for(this.advance();;){if(!k(this.peek))if(this.peek===95){if(!k(this.input.charCodeAt(this.index-1))||!k(this.input.charCodeAt(this.index+1)))return this.error("Invalid numeric separator",0);s=!0}else if(this.peek===46)e=!1;else if(fs(this.peek)){if(this.advance(),ds(this.peek)&&this.advance(),!k(this.peek))return this.error("Invalid exponent",-1);e=!1}else break;this.advance()}let i=this.input.substring(t,this.index);s&&(i=i.replace(/_/g,""));let n=e?gs(i):parseFloat(i);return ls(t,this.index,n)}scanString(){let t=this.index,e=this.peek;this.advance();let s="",i=this.index,n=this.input;for(;this.peek!=e;)if(this.peek==92){s+=n.substring(i,this.index);let o;if(this.advance(),this.peek==117){let c=n.substring(this.index+1,this.index+5);if(/^[0-9a-f]+$/i.test(c))o=parseInt(c,16);else return this.error(`Invalid unicode escape [\\u${c}]`,0);for(let h=0;h<5;h++)this.advance()}else o=vs(this.peek),this.advance();s+=String.fromCharCode(o),i=this.index}else{if(this.peek==0)return this.error("Unterminated quote",0);this.advance()}let a=n.substring(i,this.index);return this.advance(),us(t,this.index,s+a)}scanQuestion(t){this.advance();let e="?";return(this.peek===63||this.peek===46)&&(e+=this.peek===46?".":"?",this.advance()),It(t,this.index,e)}error(t,e){let s=this.index+e;return xs(s,this.index,`Lexer Error: ${t} at column ${s} in expression [${this.input}]`)}};function Jt(r){return 97<=r&&r<=122||65<=r&&r<=90||r==95||r==36}function Xt(r){return zt(r)||k(r)||r==95||r==36}function fs(r){return r==101||r==69}function ds(r){return r==45||r==43}function vs(r){switch(r){case 110:return 10;case 102:return 12;case 114:return 13;case 116:return 9;case 118:return 11;default:return r}}function gs(r){let t=parseInt(r);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+r);return t}var ms=[/@/,/^\s*$/,/[<>]/,/^[{}]$/,/&(#|[a-z])/i,/^\/\//];function re(r,t){if(t!=null&&!(Array.isArray(t)&&t.length==2))throw new Error(`Expected '${r}' to be an array, [start, end].`);if(t!=null){let e=t[0],s=t[1];ms.forEach(i=>{if(i.test(e)||i.test(s))throw new Error(`['${e}', '${s}'] contains unusable interpolation symbol.`)})}}var Lt=class r{static fromArray(t){return t?(re("interpolation",t),new r(t[0],t[1])):_}constructor(t,e){this.start=t,this.end=e}},_=new Lt("{{","}}");var Rt=class{constructor(t,e,s){this.strings=t,this.expressions=e,this.offsets=s}},Pt=class{constructor(t,e,s){this.templateBindings=t,this.warnings=e,this.errors=s}},ot=class{constructor(t){this._lexer=t,this.errors=[]}parseAction(t,e,s,i=_){this._checkNoInterpolation(t,e,i);let n=this._stripComments(t),a=this._lexer.tokenize(n),o=new U(t,e,s,a,1,this.errors,0).parseChain();return new C(o,t,e,s,this.errors)}parseBinding(t,e,s,i=_){let n=this._parseBindingAst(t,e,s,i);return new C(n,t,e,s,this.errors)}checkSimpleExpression(t){let e=new bt;return t.visit(e),e.errors}parseSimpleBinding(t,e,s,i=_){let n=this._parseBindingAst(t,e,s,i),a=this.checkSimpleExpression(n);return a.length>0&&this._reportError(`Host binding expression cannot contain ${a.join(" ")}`,t,e),new C(n,t,e,s,this.errors)}_reportError(t,e,s,i){this.errors.push(new F(t,e,s,i))}_parseBindingAst(t,e,s,i){this._checkNoInterpolation(t,e,i);let n=this._stripComments(t),a=this._lexer.tokenize(n);return new U(t,e,s,a,0,this.errors,0).parseChain()}parseTemplateBindings(t,e,s,i,n){let a=this._lexer.tokenize(e);return new U(e,s,n,a,0,this.errors,0).parseTemplateBindings({source:t,span:new E(i,i+t.length)})}parseInterpolation(t,e,s,i,n=_){let{strings:a,expressions:o,offsets:c}=this.splitInterpolation(t,e,i,n);if(o.length===0)return null;let h=[];for(let u=0;u<o.length;++u){let x=o[u].text,f=this._stripComments(x),$=this._lexer.tokenize(f),d=new U(t,e,s,$,0,this.errors,c[u]).parseChain();h.push(d)}return this.createInterpolationAst(a.map(u=>u.text),h,t,e,s)}parseInterpolationExpression(t,e,s){let i=this._stripComments(t),n=this._lexer.tokenize(i),a=new U(t,e,s,n,0,this.errors,0).parseChain(),o=["",""];return this.createInterpolationAst(o,[a],t,e,s)}createInterpolationAst(t,e,s,i,n){let a=new O(0,s.length),o=new Y(a,a.toAbsolute(n),t,e);return new C(o,s,i,n,this.errors)}splitInterpolation(t,e,s,i=_){let n=[],a=[],o=[],c=s?Ss(s):null,h=0,u=!1,x=!1,{start:f,end:$}=i;for(;h<t.length;)if(u){let d=h,N=d+f.length,A=this._getInterpolationEndIndex(t,$,N);if(A===-1){u=!1,x=!0;break}let ft=A+$.length,Ft=t.substring(N,A);Ft.trim().length===0&&this._reportError("Blank expressions are not allowed in interpolated strings",t,`at column ${h} in`,e),a.push({text:Ft,start:d,end:ft});let Oe=(c?.get(d)??d)+f.length;o.push(Oe),h=ft,u=!1}else{let d=h;h=t.indexOf(f,h),h===-1&&(h=t.length);let N=t.substring(d,h);n.push({text:N,start:d,end:h}),u=!0}if(!u)if(x){let d=n[n.length-1];d.text+=t.substring(h),d.end=t.length}else n.push({text:t.substring(h),start:h,end:t.length});return new Rt(n,a,o)}wrapLiteralPrimitive(t,e,s){let i=new O(0,t==null?0:t.length);return new C(new g(i,i.toAbsolute(s),t),t,e,s,this.errors)}_stripComments(t){let e=this._commentStart(t);return e!=null?t.substring(0,e):t}_commentStart(t){let e=null;for(let s=0;s<t.length-1;s++){let i=t.charCodeAt(s),n=t.charCodeAt(s+1);if(i===47&&n==47&&e==null)return s;e===i?e=null:e==null&&At(i)&&(e=i)}return null}_checkNoInterpolation(t,e,{start:s,end:i}){let n=-1,a=-1;for(let o of this._forEachUnquotedChar(t,0))if(n===-1)t.startsWith(s)&&(n=o);else if(a=this._getInterpolationEndIndex(t,i,o),a>-1)break;n>-1&&a>-1&&this._reportError(`Got interpolation (${s}${i}) where expression was expected`,t,`at column ${n} in`,e)}_getInterpolationEndIndex(t,e,s){for(let i of this._forEachUnquotedChar(t,s)){if(t.startsWith(e,i))return i;if(t.startsWith("//",i))return t.indexOf(e,i)}return-1}*_forEachUnquotedChar(t,e){let s=null,i=0;for(let n=e;n<t.length;n++){let a=t[n];At(t.charCodeAt(n))&&(s===null||s===a)&&i%2===0?s=s===null?a:null:s===null&&(yield n),i=a==="\\"?i+1:0}}},at;(function(r){r[r.None=0]="None",r[r.Writable=1]="Writable"})(at||(at={}));var U=class{constructor(t,e,s,i,n,a,o){this.input=t,this.location=e,this.absoluteOffset=s,this.tokens=i,this.parseFlags=n,this.errors=a,this.offset=o,this.rparensExpected=0,this.rbracketsExpected=0,this.rbracesExpected=0,this.context=at.None,this.sourceSpanCache=new Map,this.index=0}peek(t){let e=this.index+t;return e<this.tokens.length?this.tokens[e]:wt}get next(){return this.peek(0)}get atEOF(){return this.index>=this.tokens.length}get inputIndex(){return this.atEOF?this.currentEndIndex:this.next.index+this.offset}get currentEndIndex(){return this.index>0?this.peek(-1).end+this.offset:this.tokens.length===0?this.input.length+this.offset:this.next.index+this.offset}get currentAbsoluteOffset(){return this.absoluteOffset+this.inputIndex}span(t,e){let s=this.currentEndIndex;if(e!==void 0&&e>this.currentEndIndex&&(s=e),t>s){let i=s;s=t,t=i}return new O(t,s)}sourceSpan(t,e){let s=`${t}@${this.inputIndex}:${e}`;return this.sourceSpanCache.has(s)||this.sourceSpanCache.set(s,this.span(t,e).toAbsolute(this.absoluteOffset)),this.sourceSpanCache.get(s)}advance(){this.index++}withContext(t,e){this.context|=t;let s=e();return this.context^=t,s}consumeOptionalCharacter(t){return this.next.isCharacter(t)?(this.advance(),!0):!1}peekKeywordLet(){return this.next.isKeywordLet()}peekKeywordAs(){return this.next.isKeywordAs()}expectCharacter(t){this.consumeOptionalCharacter(t)||this.error(`Missing expected ${String.fromCharCode(t)}`)}consumeOptionalOperator(t){return this.next.isOperator(t)?(this.advance(),!0):!1}expectOperator(t){this.consumeOptionalOperator(t)||this.error(`Missing expected operator ${t}`)}prettyPrintToken(t){return t===wt?"end of input":`token ${t}`}expectIdentifierOrKeyword(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier or keyword"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier or keyword`),null):(this.advance(),t.toString())}expectIdentifierOrKeywordOrString(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()&&!t.isString()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier, keyword or string"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier, keyword, or string`),""):(this.advance(),t.toString())}parseChain(){let t=[],e=this.inputIndex;for(;this.index<this.tokens.length;){let s=this.parsePipe();if(t.push(s),this.consumeOptionalCharacter(59))for(this.parseFlags&1||this.error("Binding expression cannot contain chained expression");this.consumeOptionalCharacter(59););else if(this.index<this.tokens.length){let i=this.index;if(this.error(`Unexpected token '${this.next}'`),this.index===i)break}}if(t.length===0){let s=this.offset,i=this.offset+this.input.length;return new v(this.span(s,i),this.sourceSpan(s,i))}return t.length==1?t[0]:new W(this.span(e),this.sourceSpan(e),t)}parsePipe(){let t=this.inputIndex,e=this.parseExpression();if(this.consumeOptionalOperator("|")){this.parseFlags&1&&this.error("Cannot have a pipe in an action expression");do{let s=this.inputIndex,i=this.expectIdentifierOrKeyword(),n,a;i!==null?n=this.sourceSpan(s):(i="",a=this.next.index!==-1?this.next.index:this.input.length+this.offset,n=new O(a,a).toAbsolute(this.absoluteOffset));let o=[];for(;this.consumeOptionalCharacter(58);)o.push(this.parseExpression());e=new q(this.span(t),this.sourceSpan(t,a),e,i,o,n)}while(this.consumeOptionalOperator("|"))}return e}parseExpression(){return this.parseConditional()}parseConditional(){let t=this.inputIndex,e=this.parseLogicalOr();if(this.consumeOptionalOperator("?")){let s=this.parsePipe(),i;if(this.consumeOptionalCharacter(58))i=this.parsePipe();else{let n=this.inputIndex,a=this.input.substring(t,n);this.error(`Conditional expression ${a} requires all 3 expressions`),i=new v(this.span(t),this.sourceSpan(t))}return new G(this.span(t),this.sourceSpan(t),e,s,i)}else return e}parseLogicalOr(){let t=this.inputIndex,e=this.parseLogicalAnd();for(;this.consumeOptionalOperator("||");){let s=this.parseLogicalAnd();e=new m(this.span(t),this.sourceSpan(t),"||",e,s)}return e}parseLogicalAnd(){let t=this.inputIndex,e=this.parseNullishCoalescing();for(;this.consumeOptionalOperator("&&");){let s=this.parseNullishCoalescing();e=new m(this.span(t),this.sourceSpan(t),"&&",e,s)}return e}parseNullishCoalescing(){let t=this.inputIndex,e=this.parseEquality();for(;this.consumeOptionalOperator("??");){let s=this.parseEquality();e=new m(this.span(t),this.sourceSpan(t),"??",e,s)}return e}parseEquality(){let t=this.inputIndex,e=this.parseRelational();for(;this.next.type==p.Operator;){let s=this.next.strValue;switch(s){case"==":case"===":case"!=":case"!==":this.advance();let i=this.parseRelational();e=new m(this.span(t),this.sourceSpan(t),s,e,i);continue}break}return e}parseRelational(){let t=this.inputIndex,e=this.parseAdditive();for(;this.next.type==p.Operator;){let s=this.next.strValue;switch(s){case"<":case">":case"<=":case">=":this.advance();let i=this.parseAdditive();e=new m(this.span(t),this.sourceSpan(t),s,e,i);continue}break}return e}parseAdditive(){let t=this.inputIndex,e=this.parseMultiplicative();for(;this.next.type==p.Operator;){let s=this.next.strValue;switch(s){case"+":case"-":this.advance();let i=this.parseMultiplicative();e=new m(this.span(t),this.sourceSpan(t),s,e,i);continue}break}return e}parseMultiplicative(){let t=this.inputIndex,e=this.parsePrefix();for(;this.next.type==p.Operator;){let s=this.next.strValue;switch(s){case"*":case"%":case"/":this.advance();let i=this.parsePrefix();e=new m(this.span(t),this.sourceSpan(t),s,e,i);continue}break}return e}parsePrefix(){if(this.next.type==p.Operator){let t=this.inputIndex,e=this.next.strValue,s;switch(e){case"+":return this.advance(),s=this.parsePrefix(),b.createPlus(this.span(t),this.sourceSpan(t),s);case"-":return this.advance(),s=this.parsePrefix(),b.createMinus(this.span(t),this.sourceSpan(t),s);case"!":return this.advance(),s=this.parsePrefix(),new Z(this.span(t),this.sourceSpan(t),s)}}return this.parseCallChain()}parseCallChain(){let t=this.inputIndex,e=this.parsePrimary();for(;;)if(this.consumeOptionalCharacter(46))e=this.parseAccessMember(e,t,!1);else if(this.consumeOptionalOperator("?."))this.consumeOptionalCharacter(40)?e=this.parseCall(e,t,!0):e=this.consumeOptionalCharacter(91)?this.parseKeyedReadOrWrite(e,t,!0):this.parseAccessMember(e,t,!0);else if(this.consumeOptionalCharacter(91))e=this.parseKeyedReadOrWrite(e,t,!1);else if(this.consumeOptionalCharacter(40))e=this.parseCall(e,t,!1);else if(this.consumeOptionalOperator("!"))e=new J(this.span(t),this.sourceSpan(t),e);else return e}parsePrimary(){let t=this.inputIndex;if(this.consumeOptionalCharacter(40)){this.rparensExpected++;let e=this.parsePipe();return this.rparensExpected--,this.expectCharacter(41),e}else{if(this.next.isKeywordNull())return this.advance(),new g(this.span(t),this.sourceSpan(t),null);if(this.next.isKeywordUndefined())return this.advance(),new g(this.span(t),this.sourceSpan(t),void 0);if(this.next.isKeywordTrue())return this.advance(),new g(this.span(t),this.sourceSpan(t),!0);if(this.next.isKeywordFalse())return this.advance(),new g(this.span(t),this.sourceSpan(t),!1);if(this.next.isKeywordThis())return this.advance(),new dt(this.span(t),this.sourceSpan(t));if(this.consumeOptionalCharacter(91)){this.rbracketsExpected++;let e=this.parseExpressionList(93);return this.rbracketsExpected--,this.expectCharacter(93),new H(this.span(t),this.sourceSpan(t),e)}else{if(this.next.isCharacter(123))return this.parseLiteralMap();if(this.next.isIdentifier())return this.parseAccessMember(new I(this.span(t),this.sourceSpan(t)),t,!1);if(this.next.isNumber()){let e=this.next.toNumber();return this.advance(),new g(this.span(t),this.sourceSpan(t),e)}else if(this.next.isString()){let e=this.next.toString();return this.advance(),new g(this.span(t),this.sourceSpan(t),e)}else return this.next.isPrivateIdentifier()?(this._reportErrorForPrivateIdentifier(this.next,null),new v(this.span(t),this.sourceSpan(t))):this.index>=this.tokens.length?(this.error(`Unexpected end of expression: ${this.input}`),new v(this.span(t),this.sourceSpan(t))):(this.error(`Unexpected token ${this.next}`),new v(this.span(t),this.sourceSpan(t)))}}}parseExpressionList(t){let e=[];do if(!this.next.isCharacter(t))e.push(this.parsePipe());else break;while(this.consumeOptionalCharacter(44));return e}parseLiteralMap(){let t=[],e=[],s=this.inputIndex;if(this.expectCharacter(123),!this.consumeOptionalCharacter(125)){this.rbracesExpected++;do{let i=this.inputIndex,n=this.next.isString(),a=this.expectIdentifierOrKeywordOrString(),o={key:a,quoted:n};if(t.push(o),n)this.expectCharacter(58),e.push(this.parsePipe());else if(this.consumeOptionalCharacter(58))e.push(this.parsePipe());else{o.isShorthandInitialized=!0;let c=this.span(i),h=this.sourceSpan(i);e.push(new L(c,h,h,new I(c,h),a))}}while(this.consumeOptionalCharacter(44)&&!this.next.isCharacter(125));this.rbracesExpected--,this.expectCharacter(125)}return new j(this.span(s),this.sourceSpan(s),t,e)}parseAccessMember(t,e,s){let i=this.inputIndex,n=this.withContext(at.Writable,()=>{let c=this.expectIdentifierOrKeyword()??"";return c.length===0&&this.error("Expected identifier for property access",t.span.end),c}),a=this.sourceSpan(i),o;if(s)this.consumeOptionalOperator("=")?(this.error("The '?.' operator cannot be used in the assignment"),o=new v(this.span(e),this.sourceSpan(e))):o=new R(this.span(e),this.sourceSpan(e),a,t,n);else if(this.consumeOptionalOperator("=")){if(!(this.parseFlags&1))return this.error("Bindings cannot contain assignments"),new v(this.span(e),this.sourceSpan(e));let c=this.parseConditional();o=new V(this.span(e),this.sourceSpan(e),a,t,n,c)}else o=new L(this.span(e),this.sourceSpan(e),a,t,n);return o}parseCall(t,e,s){let i=this.inputIndex;this.rparensExpected++;let n=this.parseCallArguments(),a=this.span(i,this.inputIndex).toAbsolute(this.absoluteOffset);this.expectCharacter(41),this.rparensExpected--;let o=this.span(e),c=this.sourceSpan(e);return s?new K(o,c,t,n,a):new X(o,c,t,n,a)}parseCallArguments(){if(this.next.isCharacter(41))return[];let t=[];do t.push(this.parsePipe());while(this.consumeOptionalCharacter(44));return t}expectTemplateBindingKey(){let t="",e=!1,s=this.currentAbsoluteOffset;do t+=this.expectIdentifierOrKeywordOrString(),e=this.consumeOptionalOperator("-"),e&&(t+="-");while(e);return{source:t,span:new E(s,s+t.length)}}parseTemplateBindings(t){let e=[];for(e.push(...this.parseDirectiveKeywordBindings(t));this.index<this.tokens.length;){let s=this.parseLetBinding();if(s)e.push(s);else{let i=this.expectTemplateBindingKey(),n=this.parseAsBinding(i);n?e.push(n):(i.source=t.source+i.source.charAt(0).toUpperCase()+i.source.substring(1),e.push(...this.parseDirectiveKeywordBindings(i)))}this.consumeStatementTerminator()}return new Pt(e,[],this.errors)}parseKeyedReadOrWrite(t,e,s){return this.withContext(at.Writable,()=>{this.rbracketsExpected++;let i=this.parsePipe();if(i instanceof v&&this.error("Key access cannot be empty"),this.rbracketsExpected--,this.expectCharacter(93),this.consumeOptionalOperator("="))if(s)this.error("The '?.' operator cannot be used in the assignment");else{let n=this.parseConditional();return new z(this.span(e),this.sourceSpan(e),t,i,n)}else return s?new P(this.span(e),this.sourceSpan(e),t,i):new Q(this.span(e),this.sourceSpan(e),t,i);return new v(this.span(e),this.sourceSpan(e))})}parseDirectiveKeywordBindings(t){let e=[];this.consumeOptionalCharacter(58);let s=this.getDirectiveBoundTarget(),i=this.currentAbsoluteOffset,n=this.parseAsBinding(t);n||(this.consumeStatementTerminator(),i=this.currentAbsoluteOffset);let a=new E(t.span.start,i);return e.push(new tt(a,t,s)),n&&e.push(n),e}getDirectiveBoundTarget(){if(this.next===wt||this.peekKeywordAs()||this.peekKeywordLet())return null;let t=this.parsePipe(),{start:e,end:s}=t.span,i=this.input.substring(e,s);return new C(t,i,this.location,this.absoluteOffset+e,this.errors)}parseAsBinding(t){if(!this.peekKeywordAs())return null;this.advance();let e=this.expectTemplateBindingKey();this.consumeStatementTerminator();let s=new E(t.span.start,this.currentAbsoluteOffset);return new T(s,e,t)}parseLetBinding(){if(!this.peekKeywordLet())return null;let t=this.currentAbsoluteOffset;this.advance();let e=this.expectTemplateBindingKey(),s=null;this.consumeOptionalOperator("=")&&(s=this.expectTemplateBindingKey()),this.consumeStatementTerminator();let i=new E(t,this.currentAbsoluteOffset);return new T(i,e,s)}consumeStatementTerminator(){this.consumeOptionalCharacter(59)||this.consumeOptionalCharacter(44)}error(t,e=null){this.errors.push(new F(t,this.input,this.locationText(e),this.location)),this.skip()}locationText(t=null){return t==null&&(t=this.index),t<this.tokens.length?`at column ${this.tokens[t].index+1} in`:"at the end of the expression"}_reportErrorForPrivateIdentifier(t,e){let s=`Private identifiers are not supported. Unexpected private identifier: ${t}`;e!==null&&(s+=`, ${e}`),this.error(s)}skip(){let t=this.next;for(;this.index<this.tokens.length&&!t.isCharacter(59)&&!t.isOperator("|")&&(this.rparensExpected<=0||!t.isCharacter(41))&&(this.rbracesExpected<=0||!t.isCharacter(125))&&(this.rbracketsExpected<=0||!t.isCharacter(93))&&(!(this.context&at.Writable)||!t.isOperator("="));)this.next.isError()&&this.errors.push(new F(this.next.toString(),this.input,this.locationText(),this.location)),this.advance(),t=this.next}},bt=class extends vt{constructor(){super(...arguments),this.errors=[]}visitPipe(){this.errors.push("pipes")}};function Ss(r){let t=new Map,e=0,s=0,i=0;for(;i<r.length;){let n=r[i];if(n.type===9){let[a,o]=n.parts;e+=o.length,s+=a.length}else{let a=n.parts.reduce((o,c)=>o+c.length,0);s+=a,e+=a}t.set(s,e),i++}return t}function ie({start:r,end:t},e){let s=r,i=t;for(;i!==s&&/\s/.test(e[i-1]);)i--;for(;s!==i&&/\s/.test(e[s]);)s++;return{start:s,end:i}}function ys({start:r,end:t},e){let s=r,i=t;for(;i!==e.length&&/\s/.test(e[i]);)i++;for(;s!==0&&/\s/.test(e[s-1]);)s--;return{start:s,end:i}}function $s(r,t){return t[r.start-1]==="("&&t[r.end]===")"?{start:r.start-1,end:r.end+1}:r}function ne(r,t,e){let s=0,i={start:r.start,end:r.end};for(;;){let n=ys(i,t),a=$s(n,t);if(n.start===a.start&&n.end===a.end)break;i.start=a.start,i.end=a.end,s++}return{hasParens:(e?s-1:s)!==0,outerSpan:ie(e?{start:i.start+1,end:i.end-1}:i,t),innerSpan:ie(r,t)}}function ae(r){return typeof r=="string"?t=>t===r:t=>r.test(t)}function oe(r,t,e){let s=ae(t);for(let i=e;i>=0;i--){let n=r[i];if(s(n))return i}throw new Error(`Cannot find front char ${t} from index ${e} in ${JSON.stringify(r)}`)}function ce(r,t,e){let s=ae(t);for(let i=e;i<r.length;i++){let n=r[i];if(s(n))return i}throw new Error(`Cannot find character ${t} from index ${e} in ${JSON.stringify(r)}`)}function he(r){return r.slice(0,1).toLowerCase()+r.slice(1)}function ut(r){let{start:t,end:e}=r;return{start:t,end:e,range:[t,e]}}var Es=r=>ot.prototype._commentStart(r);function Cs(r,t){let e=t?Es(r):null;if(e===null)return{text:r,comments:[]};let s={type:"CommentLine",value:r.slice(e+2),...ut({start:e,end:r.length})};return{text:r.slice(0,e),comments:[s]}}function lt(r,t=!0){return e=>{let s=new ct,i=new ot(s),{text:n,comments:a}=Cs(e,t),o=r(n,i);if(o.errors.length!==0){let[{message:c}]=o.errors;throw new SyntaxError(c.replace(/^Parser Error: | at column \d+ in [^]*$/g,""))}return{result:o,comments:a,text:n}}}var pe=lt((r,t)=>t.parseBinding(r,"",0)),As=lt((r,t)=>t.parseSimpleBinding(r,"",0)),ue=lt((r,t)=>t.parseAction(r,"",0)),le=lt((r,t)=>t.parseInterpolationExpression(r,"",0)),xe=lt((r,t)=>t.parseTemplateBindings("",r,"",0,0),!1);var Is=(r,t,e)=>{if(!(r&&t==null))return Array.isArray(t)||typeof t=="string"?t[e<0?t.length+e:e]:t.at(e)},yt=Is;var Kt=class{text;constructor(t){this.text=t}getCharacterIndex(t,e){return ce(this.text,t,e)}getCharacterLastIndex(t,e){return oe(this.text,t,e)}transformSpan(t,{stripSpaces:e=!1,hasParentParens:s=!1}={}){if(!e)return ut(t);let{outerSpan:i,innerSpan:n,hasParens:a}=ne(t,this.text,s),o=ut(n);return a&&(o.extra={parenthesized:!0,parenStart:i.start,parenEnd:i.end}),o}createNode(t,{stripSpaces:e=!0,hasParentParens:s=!1}={}){let{type:i,start:n,end:a}=t,o={...t,...this.transformSpan({start:n,end:a},{stripSpaces:e,hasParentParens:s})};switch(i){case"NumericLiteral":case"StringLiteral":{let c=this.text.slice(o.start,o.end),{value:h}=o;o.extra={...o.extra,raw:c,rawValue:h};break}case"ObjectProperty":{let{shorthand:c}=o;c&&(o.extra={...o.extra,shorthand:c});break}}return o}},fe=Kt;function Tt(r){return!!r.extra?.parenthesized}function w(r){return Tt(r)?r.extra.parenStart:r.start}function y(r){return Tt(r)?r.extra.parenEnd:r.end}function de(r){return(r.type==="OptionalCallExpression"||r.type==="OptionalMemberExpression")&&!Tt(r)}function ve(r,t){let{start:e,end:s}=r.sourceSpan;return e>=s||/^\s+$/.test(t.slice(e,s))}var xt=class extends fe{#i;#r;constructor(t,e){super(e),this.#i=t,this.#r=e}get node(){return this.#e(this.#i)}transformNode(t){return this.#n(t)}#t(t,{stripSpaces:e=!0,hasParentParens:s=!1}={}){return this.createNode(t,{stripSpaces:e,hasParentParens:s})}#s(t,e,{computed:s,optional:i,end:n=y(e),hasParentParens:a=!1}){if(ve(t,this.#r)||t.sourceSpan.start===e.start)return e;let o=this.#e(t),c=de(o);return this.#t({type:i||c?"OptionalMemberExpression":"MemberExpression",object:o,property:e,computed:s,...i?{optional:!0}:c?{optional:!1}:void 0,start:w(o),end:n},{hasParentParens:a})}#e(t,e=!1){return this.#n(t,e)}#n(t,e=!1){if(t instanceof Y){let{expressions:s}=t;if(s.length!==1)throw new Error("Unexpected 'Interpolation'");return this.#e(s[0])}if(t instanceof b)return this.#t({type:"UnaryExpression",prefix:!0,argument:this.#e(t.expr),operator:t.operator,...t.sourceSpan},{hasParentParens:e});if(t instanceof m){let{left:s,operation:i,right:n}=t,a=this.#e(s),o=this.#e(n),c=w(a),h=y(o),u={left:a,right:o,start:c,end:h};return i==="&&"||i==="||"||i==="??"?this.#t({...u,type:"LogicalExpression",operator:i},{hasParentParens:e}):this.#t({...u,type:"BinaryExpression",operator:i},{hasParentParens:e})}if(t instanceof q){let{exp:s,name:i,args:n}=t,a=this.#e(s),o=w(a),c=y(a),h=this.getCharacterIndex(/\S/,this.getCharacterIndex("|",c)+1),u=this.#t({type:"Identifier",name:i,start:h,end:h+i.length}),x=n.map(f=>this.#e(f));return this.#t({type:"NGPipeExpression",left:a,right:u,arguments:x,start:o,end:y(x.length===0?u:yt(!1,x,-1))},{hasParentParens:e})}if(t instanceof W)return this.#t({type:"NGChainedExpression",expressions:t.expressions.map(s=>this.#e(s)),...t.sourceSpan},{hasParentParens:e});if(t instanceof G){let{condition:s,trueExp:i,falseExp:n}=t,a=this.#e(s),o=this.#e(i),c=this.#e(n);return this.#t({type:"ConditionalExpression",test:a,consequent:o,alternate:c,start:w(a),end:y(c)},{hasParentParens:e})}if(t instanceof v)return this.#t({type:"NGEmptyExpression",...t.sourceSpan},{hasParentParens:e});if(t instanceof I)return this.#t({type:"ThisExpression",...t.sourceSpan},{hasParentParens:e});if(t instanceof Q||t instanceof P)return this.#s(t.receiver,this.#e(t.key),{computed:!0,optional:t instanceof P,end:t.sourceSpan.end,hasParentParens:e});if(t instanceof H)return this.#t({type:"ArrayExpression",elements:t.expressions.map(s=>this.#e(s)),...t.sourceSpan},{hasParentParens:e});if(t instanceof j){let{keys:s,values:i}=t,n=i.map(o=>this.#e(o)),a=s.map(({key:o,quoted:c},h)=>{let u=n[h],x=w(u),f=y(u),$=this.getCharacterIndex(/\S/,h===0?t.sourceSpan.start+1:this.getCharacterIndex(",",y(n[h-1]))+1),d=x===$?f:this.getCharacterLastIndex(/\S/,this.getCharacterLastIndex(":",x-1)-1)+1,N={start:$,end:d},A=c?this.#t({type:"StringLiteral",value:o,...N}):this.#t({type:"Identifier",name:o,...N}),ft=A.end<A.start||$===x;return this.#t({type:"ObjectProperty",key:A,value:u,shorthand:ft,computed:!1,start:w(A),end:f})});return this.#t({type:"ObjectExpression",properties:a,...t.sourceSpan},{hasParentParens:e})}if(t instanceof g){let{value:s}=t;switch(typeof s){case"boolean":return this.#t({type:"BooleanLiteral",value:s,...t.sourceSpan},{hasParentParens:e});case"number":return this.#t({type:"NumericLiteral",value:s,...t.sourceSpan},{hasParentParens:e});case"object":return this.#t({type:"NullLiteral",...t.sourceSpan},{hasParentParens:e});case"string":return this.#t({type:"StringLiteral",value:s,...t.sourceSpan},{hasParentParens:e});case"undefined":return this.#t({type:"Identifier",name:"undefined",...t.sourceSpan},{hasParentParens:e});default:throw new Error(`Unexpected LiteralPrimitive value type ${typeof s}`)}}if(t instanceof X||t instanceof K){let s=t instanceof K,{receiver:i,args:n}=t,a=n.length===1?[this.#e(n[0],!0)]:n.map(u=>this.#e(u)),o=this.#e(i),c=de(o),h=s||c?"OptionalCallExpression":"CallExpression";return this.#t({type:h,callee:o,arguments:a,optional:h==="OptionalCallExpression"?s:void 0,start:w(o),end:t.sourceSpan.end},{hasParentParens:e})}if(t instanceof J){let s=this.#e(t.expression);return this.#t({type:"TSNonNullExpression",expression:s,start:w(s),end:t.sourceSpan.end},{hasParentParens:e})}if(t instanceof Z){let s=this.#e(t.expression);return this.#t({type:"UnaryExpression",prefix:!0,operator:"!",argument:s,start:t.sourceSpan.start,end:y(s)},{hasParentParens:e})}if(t instanceof L||t instanceof R){let{receiver:s,name:i}=t,n=this.getCharacterLastIndex(/\S/,t.sourceSpan.end-1)+1,a=this.#t({type:"Identifier",name:i,start:n-i.length,end:n},ve(s,this.#r)?{hasParentParens:e}:{});return this.#s(s,a,{computed:!1,optional:t instanceof R,hasParentParens:e})}if(t instanceof z){let s=this.#e(t.key),i=this.#e(t.value),n=this.#s(t.receiver,s,{computed:!0,optional:!1,end:this.getCharacterIndex("]",y(s))+1});return this.#t({type:"AssignmentExpression",left:n,operator:"=",right:i,start:w(n),end:y(i)},{hasParentParens:e})}if(t instanceof V){let{receiver:s,name:i,value:n}=t,a=this.#e(n),o=this.getCharacterLastIndex(/\S/,this.getCharacterLastIndex("=",w(a)-1)-1)+1,c=this.#t({type:"Identifier",name:i,start:o-i.length,end:o}),h=this.#s(s,c,{computed:!1,optional:!1});return this.#t({type:"AssignmentExpression",left:h,operator:"=",right:a,start:w(h),end:y(a)},{hasParentParens:e})}throw Object.assign(new Error("Unexpected node"),{node:t})}};function ge(r,t){return new xt(r,t).node}function me(r){return r instanceof tt}function Se(r){return r instanceof T}var Bt=class extends xt{#i;#r;constructor(t,e){super(void 0,e),this.#i=t,this.#r=e;for(let s of t)this.#o(s)}get expressions(){return this.#h()}get#t(){return this.#i[0].key}#s(t,{stripSpaces:e=!0}={}){return this.createNode(t,{stripSpaces:e})}#e(t){return this.transformNode(t)}#n(t){return he(t.slice(this.#t.source.length))}#a(t){let e=this.#r;if(e[t.start]!=='"'&&e[t.start]!=="'")return;let s=e[t.start],i=!1;for(let n=t.start+1;n<e.length;n++)switch(e[n]){case s:if(!i){t.end=n+1;return}default:i=!1;break;case"\\":i=!i;break}}#o(t){this.#a(t.key.span),Se(t)&&t.value&&this.#a(t.value.span)}#c(t){if(!t.value||t.value.source)return t.value;let e=this.getCharacterIndex(/\S/,t.sourceSpan.start);return{source:"$implicit",span:{start:e,end:e}}}#h(){let t=this.#i,[e]=t,s=this.#r.slice(e.sourceSpan.start,e.sourceSpan.end).trim().length===0?t.slice(1):t,i=[],n=null;for(let[a,o]of s.entries()){if(n&&me(n)&&Se(o)&&o.value&&o.value.source===n.key.source){let c=this.#s({type:"NGMicrosyntaxKey",name:o.key.source,...o.key.span}),h=(f,$)=>({...f,...this.transformSpan({start:f.start,end:$})}),u=f=>({...h(f,c.end),alias:c}),x=i.pop();if(x.type==="NGMicrosyntaxExpression")i.push(u(x));else if(x.type==="NGMicrosyntaxKeyedExpression"){let f=u(x.expression);i.push(h({...x,expression:f},f.end))}else throw new Error(`Unexpected type ${x.type}`)}else i.push(this.#p(o,a));n=o}return this.#s({type:"NGMicrosyntax",body:i,...i.length===0?t[0].sourceSpan:{start:i[0].start,end:yt(!1,i,-1).end}})}#p(t,e){if(me(t)){let{key:s,value:i}=t;return i?e===0?this.#s({type:"NGMicrosyntaxExpression",expression:this.#e(i.ast),alias:null,...i.sourceSpan}):this.#s({type:"NGMicrosyntaxKeyedExpression",key:this.#s({type:"NGMicrosyntaxKey",name:this.#n(s.source),...s.span}),expression:this.#s({type:"NGMicrosyntaxExpression",expression:this.#e(i.ast),alias:null,...i.sourceSpan}),start:s.span.start,end:i.sourceSpan.end}):this.#s({type:"NGMicrosyntaxKey",name:this.#n(s.source),...s.span})}else{let{key:s,sourceSpan:i}=t;if(/^let\s$/.test(this.#r.slice(i.start,i.start+4))){let{value:a}=t;return this.#s({type:"NGMicrosyntaxLet",key:this.#s({type:"NGMicrosyntaxKey",name:s.source,...s.span}),value:a?this.#s({type:"NGMicrosyntaxKey",name:a.source,...a.span}):null,start:i.start,end:a?a.span.end:s.span.end})}else{let a=this.#c(t);return this.#s({type:"NGMicrosyntaxAs",key:this.#s({type:"NGMicrosyntaxKey",name:a.source,...a.span}),alias:this.#s({type:"NGMicrosyntaxKey",name:s.source,...s.span}),start:a.span.start,end:s.span.end})}}}};function we(r,t){return new Bt(r,t).expressions}function $t({result:{ast:r},text:t,comments:e}){return Object.assign(ge(r,t),{comments:e})}function ye({result:{templateBindings:r},text:t}){return we(r,t)}var $e=r=>$t(pe(r));var Ee=r=>$t(le(r)),Mt=r=>$t(ue(r)),Ce=r=>ye(xe(r));function _t(r){let t=r.range?.[0]??r.start,e=(r.declaration?.decorators??r.decorators)?.[0];return e?Math.min(_t(e),t):t}function Ae(r){return r.range?.[1]??r.end}function Et(r){return{astFormat:"estree",parse(t){let e=r(t);return{type:"NGRoot",node:r===Mt&&e.type!=="NGChainedExpression"?{...e,type:"NGChainedExpression",expressions:[e]}:e}},locStart:_t,locEnd:Ae}}var ks=Et(Mt),Ns=Et($e),Ls=Et(Ee),Rs=Et(Ce);return Re(Ps);});